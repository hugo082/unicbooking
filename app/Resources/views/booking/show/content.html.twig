<style media="screen">
#edited {
    background-color: #5cb85c;

    display: inline;
    padding: .2em .6em .3em;
    font-size: 75%;
    font-weight: 700;
    line-height: 1;
    color: #fff;
    text-align: center;
    white-space: nowrap;
    vertical-align: baseline;
    border-radius: .25em;
}
</style>
{% if activeSubbooks is defined and not activeSubbooks is empty %}
<div class="card">
    <h3 class="card-header">History</h3>
    <div class="card-block">
        <table class="table">
            <thead>
                <th>ID</th>
                <th>Number</th>
                <th>Date</th>
                <th>Charged</th>
                <th>State</th>
            </thead>
            <tbody>
                {% for sub in activeSubbooks %}
                <tr id="{{ sub.number }}">
                    <td>{{ sub.id }}</td>
                    <td>{{ sub.number }}</td>
                    <td>{{ sub.creationdate|date("d M Y") }}</td>
                    <td>{{ sub.charged ? '25€' : '0€' }}</td>
                    <td>
                        {% if sub.state == 'WAITING' %}
                        <span class="label label-default">{{ 'book.state.wait.title'|trans }}</span>
                        {% elseif sub.state == 'ACCEPTED' %}
                        <span class="label label-success">{{ 'book.state.acc.title'|trans }}</span>
                        {% elseif sub.state == 'REFUSED' %}
                        <span class="label label-danger">{{ 'book.state.ref.title'|trans }}</span>
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>
{% endif %}
<div class="card">
    <h3 class="card-header">Agent</h3>
    <div class="card-block">
        <table class="table">
            <tbody>
                <tr>
                    <td class="col-md-6">{{ 'agent.username'|trans }}</td>
                    <td class="value">{{book.user.username}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'agent.fname'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.agentfirstname ? 'edited' : '' }}">{{book.agentfirstname}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'agent.lname'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.agentlastname ? 'edited' : '' }}">{{book.agentlastname}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'agent.email'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.agentemail ? 'edited' : '' }}">{{book.agentemail}}</span></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
<div class="card">
    <h3 class="card-header">Service</h3>
    <div class="card-block">
        <table class="table">
            <tbody>
                <tr>
                    <td class="col-md-6">{{ 'manage.find.form.number'|trans }}</td>
                    <td class="value"><span id="id">{{book.fullid}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">Type</td>
                    <td class="value"><span id="{{ edi and subbook.service ? 'edited' : '' }}">{% if book.service == 'DEP' %}{{ 'book.form.dep'|trans }}{% else %}{{ 'book.form.arr'|trans }}{% endif %}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.date'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.date ? 'edited' : '' }}">{{book.date|date("d M Y")}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.prod'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.product ? 'edited' : '' }}">{{book.product.name}} {{book.product.price}}€</span></td>
                </tr>
                {% if not book.nameboard is empty %}
                <tr>
                    <td class="col-md-6">{{ 'book.form.nameboard'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.nameboard ? 'edited' : '' }}">{{book.nameboard}}</span></td>
                </tr>
                {% endif %}
                <tr>
                    <td class="col-md-6">{{ 'price'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.price ? 'edited' : '' }}">{{book.price}} €</span></td>
                </tr>
                {% if book.product.code == "FAM" %}
                <tr>
                    <td class="col-md-6">{{ 'book.form.timepu'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.timepu ? 'edited' : '' }}">{{book.timepu|date("H:m")}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.addpu'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.addresspu ? 'edited' : '' }}">{{book.addresspu}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.adddo'|trans }}</td>
                    <td class="value"><span id="{{ edi and subbook.addressdo ? 'edited' : '' }}">{{book.addressdo}}</span></td>
                </tr>
                {% endif %}
            </tbody>
        </table>
    </div>
</div>
<div class="card">
    <h3 class="card-header">
        <span id="{{ edi and (subbook.adultcus or subbook.childcus or subbook.bags)  ? 'edited' : '' }}">
            {{ 'book.form.cust'|trans }}
        </span>
    </h3>
    <div class="card-block">
        <table class="table">
            <tbody>
                <tr>
                    <td class="col-md-6">{{ 'total'|trans }}</td>
                    <td class="value">{{book.totalcus}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.adult'|trans }}</td>
                    <td class="value">{{book.adultcus}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.chilu2y'|trans }}</td>
                    <td class="value">{{book.childcus}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.form.bags'|trans }}</td>
                    <td class="value">{{book.bags}} bag(s) ( {{book.bags * 10}} € )</td>
                </tr>
            </tbody>
        </table>
        <h5>{{ 'cust.inf'|trans }} ({{ book.customers|length}})</h5>
        <style media="screen">
        .table {
            margin: 0
        }
        .customer_row {
            padding: 15px;
        }
        .customer_row > * {
            margin: 0 10px
        }
        .customer_row .customer_fname {
            text-transform: uppercase;
            font-weight: 700
        }
        </style>
        {% for customer in book.customers %}

        <div class="customer_row">
            <span class="customer_title">{{customer.title}}</span>
            <span class="customer_fname">{{customer.firstname}}</span>
            <span class="customer_lname">{{customer.lastname}}</span>
            <span class="customer_lname">{{customer.cabin}}</span>
            <span class="customer_phone">{{customer.phone}}</span>
        </div>
        {% endfor %}
    </div>
</div>
<div class="card">
    <h3 class="card-header"><span id="{{ edi and subbook.flight ? 'edited' : '' }}">{{ 'book.form.flight'|trans }}</span></h3>
    <div class="card-block">
        <table class="table">
            <tbody>
                <tr>
                    <td class="col-md-6">{{ 'book.flight.number'|trans }}</td>
                    <td class="value">{{book.flight.number}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.flight.deptime'|trans }}</td>
                    <td class="value">{{book.flight.deptime|date('H:i')}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.flight.arrtime'|trans }}</td>
                    <td class="value">{{book.flight.arrtime|date('H:i')}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'book.flight.dest'|trans }}</td>
                    <td class="value">{{book.flight.destination}}</td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% if not book.driver is empty %}
<div class="card">
    <h3 class="card-header">Greeter</h3>
    <div class="card-block">
        <table class="table">
            <tbody>
                <tr>
                    <td class="col-md-6">{{ 'admin.driver_add.form.fname'|trans }}</td>
                    <td class="value">{{book.driver.firstname}}</td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'admin.driver_add.form.lname'|trans }}</td>
                    <td class="value"><span id="fdate">{{book.driver.lastname}}</span></td>
                </tr>
                <tr>
                    <td class="col-md-6">{{ 'admin.driver_add.form.phone'|trans }}</td>
                    <td class="value"><span id="products">{{book.driver.phone}}</span></td>
                </tr>
            </tbody>
        </table>
    </div>
</div>
{% endif %}
