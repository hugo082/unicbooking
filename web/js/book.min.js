$(function(){$("#appbundle_book_date").datepicker({numberOfMonths:3,showButtonPanel:true,dateFormat:"yy-mm-dd"});$("#appbundle_book_timepu").timepicker({defaultTime:false,minuteStep:5,showMeridian:false})});function CheckRequired(e){var t=$(this);if(t.find(":input[required],select[required],textarea[required]").filter(function(){return this.value===""}).length>0){e.preventDefault();alert("One or more fields required are blank")}}$(document).ready(function(){$("form").on("submit",CheckRequired)});function getMaxB(){return $("select#appbundle_book_product").val()!=3?999:10}function getMaxP(){return $("select#appbundle_book_product").val()!=3?999:6}function getNbP(){var e=$("#appbundle_book_childcus").val()==""?0:parseInt($("#appbundle_book_childcus").val());var t=$("#appbundle_book_adultcus").val()==""?0:parseInt($("#appbundle_book_adultcus").val());return e+t}function updateFlightSelection(){var e=$("select#appbundle_book_service").val();var e=$("select#appbundle_book_service").val();aval=$("select#appbundle_book_airport").val();updateFlightTransitVisibility(true);$("#appbundle_book_flight").val("")}function updateFlightTransitVisibility(e){var t=$("select#appbundle_book_service").val();if(t!="TRA")$("#flight_transit_bloc").addClass("hidden");else{$("#flight_transit_bloc").removeClass("hidden");if(e)updateFlightTransitSelection()}}function updateAddressVisibily(){var e=$("select#appbundle_book_product option:selected").attr("trspt");var t=$("select#appbundle_book_service").val();if(!e||t=="TRA"){$("#address").addClass("hidden");$("#appbundle_book_addressdo").removeAttr("required");$("#appbundle_book_addresspu").removeAttr("required");$("#appbundle_book_addressdo").removeAttr("readonly");$("#appbundle_book_addresspu").removeAttr("readonly")}else{$("#address").removeClass("hidden");updateAddress()}}function updateAddress(){var e=$("select#appbundle_book_service").val();if(e=="ARR"){$("#appbundle_book_addresspu").prop("readonly","true");$("#appbundle_book_addresspu").val("CDG Airport Terminal 1 - Gate 8");$("#appbundle_book_addressdo").removeAttr("readonly");$("#appbundle_book_addressdo").prop("required","required");$("#addresse_timepu").addClass("hidden")}else if(e=="DEP"){$("#appbundle_book_addresspu").removeAttr("readonly");$("#appbundle_book_addresspu").prop("required","required");$("#appbundle_book_addressdo").val("CDG Airport Terminal 1 - Gate 28");$("#appbundle_book_addressdo").prop("readonly","true");$("#addresse_timepu").removeClass("hidden")}}$("#appbundle_book_adultcus").on("change",function(){var e=getMaxP();if(this.value>e){$(this).val(e)}var t=parseInt($("#appbundle_book_childcus").val());var i=parseInt($(this).val());if(t+i>e){$("#appbundle_book_childcus").val(e-i)}});$("#appbundle_book_childcus").on("change",function(){var e=getMaxP();if(this.value>e){$(this).val(e)}var t=parseInt($("#appbundle_book_adultcus").val());var i=parseInt($(this).val());if(t+i>e){$("#appbundle_book_adultcus").val(e-i)}});$("select#appbundle_book_service").on("change",function(){updateFlightSelection();updateAddressVisibily()});$("select#appbundle_book_airport").on("change",function(){updateFlightSelection()});$("select#appbundle_book_product").on("change",function(){updateAddressVisibily()});$("#appbundle_book_bags").on("change",function(){var e=getMaxB();if(this.value>e){$(this).val(e)}});updateAddressVisibily();updateFlightTransitVisibility(false);$(function(){function e(e,t){this.inputId=e;this.hiddenInputId=t;this.flightModal="#flightOaciModal";this.flightModal_cancel=this.flightModal+"_cancel";this.flightModal_origin=this.flightModal+"_origin";this.flightModal_departure_time=this.flightModal+"_departure_time";this.flightModal_destination=this.flightModal+"_destination";this.flightModal_arrival_time=this.flightModal+"_arrival_time";this.loadFlight=function(){var e=$(this.inputId).val();if(typeof e==="undefined"||e==="")return;var t=this;$.ajax({type:"GET",url:"http://localhost:8000/data/api/flight",data:{flight_code:e},success:function(e){console.log(e);if(e.status.code!=200){t.internalError(e.status);return}$(t.hiddenInputId).val(e.flight.id);t.displayModal(e.flight)}})};this.displayModal=function(e){var t=new Date(1e3*e.origin_time),i=new Date(1e3*e.destination_time);$(this.flightModal).modal("show");$(this.flightModal_origin).text("Origin : "+e.origin.name);$(this.flightModal_departure_time).text("Departure time : "+t.toLocaleTimeString());$(this.flightModal_destination).text("Destination : "+e.destination.name);$(this.flightModal_arrival_time).text("Arrival time : "+i.toLocaleTimeString())};this.internalError=function(e){alert("Error : "+e.message);$(this.inputId).val("")};this.cancel=function(){$(this.inputId).val("")};this.listen=function(){var e=this;$(this.inputId).change(function(){e.loadFlight()});$(this.flightModal).on("click",e.flightModal_cancel,function(t){e.cancel()})}}var t=new e("#appbundle_book_flight_codes_code","#appbundle_book_flight_id");t.listen();var i=new e("#appbundle_book_flighttransit_codes_code","#appbundle_book_flighttransit_id");i.listen()});